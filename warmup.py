import streamlit as st
import random

def get_warmup_task(subject):
    tasks = {
        "–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞": [
            {"q": "–°–∫–æ–ª—å–∫–æ –±—É–¥–µ—Ç 15¬≤?", "a": "225"},
            {"q": "–ö–æ—Ä–µ–Ω—å –∏–∑ 144?", "a": "12"},
            {"q": "–†–µ—à–∏: 2x + 5 = 15. –ß–µ–º—É —Ä–∞–≤–µ–Ω x?", "a": "5"}
        ],
        "–§–∏–∑–∏–∫–∞": [
            {"q": "–ù–∞–ø–∏—à–∏ —Ñ–æ—Ä–º—É–ª—É —Å–∫–æ—Ä–æ—Å—Ç–∏ (—á–µ—Ä–µ–∑ s –∏ t).", "a": "v = s/t"},
            {"q": "–í —á–µ–º –∏–∑–º–µ—Ä—è–µ—Ç—Å—è —Å–∏–ª–∞?", "a": "–í –ù—å—é—Ç–æ–Ω–∞—Ö (–ù)"},
            {"q": "–ß–µ–º—É —Ä–∞–≤–Ω–∞ —Å–∫–æ—Ä–æ—Å—Ç—å —Å–≤–µ—Ç–∞? (–ø—Ä–∏–º–µ—Ä–Ω–æ)", "a": "300 000 –∫–º/—Å"}
        ],
        "–ë–∏–æ–ª–æ–≥–∏—è": [
            {"q": "–ö–∞–∫ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è —ç–Ω–µ—Ä–≥–µ—Ç–∏—á–µ—Å–∫–∞—è —Å—Ç–∞–Ω—Ü–∏—è –∫–ª–µ—Ç–∫–∏?", "a": "–ú–∏—Ç–æ—Ö–æ–Ω–¥—Ä–∏—è"},
            {"q": "–ü—Ä–æ—Ü–µ—Å—Å —Å–æ–∑–¥–∞–Ω–∏—è –≥–ª—é–∫–æ–∑—ã –∏–∑ —Å–≤–µ—Ç–∞?", "a": "–§–æ—Ç–æ—Å–∏–Ω—Ç–µ–∑"},
            {"q": "–°–∫–æ–ª—å–∫–æ –∫–∞–º–µ—Ä –≤ —Å–µ—Ä–¥—Ü–µ —á–µ–ª–æ–≤–µ–∫–∞?", "a": "4"}
        ],
        "–ò—Å—Ç–æ—Ä–∏—è": [
            {"q": "–í –∫–∞–∫–æ–º –≥–æ–¥—É –Ω–∞—á–∞–ª–∞—Å—å –í—Ç–æ—Ä–∞—è –º–∏—Ä–æ–≤–∞—è –≤–æ–π–Ω–∞?", "a": "1939"},
            {"q": "–ö—Ç–æ –±—ã–ª –ø–µ—Ä–≤—ã–º –ø—Ä–µ–∑–∏–¥–µ–Ω—Ç–æ–º –°–®–ê?", "a": "–î–∂–æ—Ä–¥–∂ –í–∞—à–∏–Ω–≥—Ç–æ–Ω"},
            {"q": "–í –∫–∞–∫–æ–º –≥–æ–¥—É –ß–∏–Ω–≥–∏—Å—Ö–∞–Ω —Å—Ç–∞–ª –≤–µ–ª–∏–∫–∏–º —Ö–∞–Ω–æ–º?", "a": "1206"}
        ]
    }
    
    subject_tasks = tasks.get(subject, [{"q": "–ì–æ—Ç–æ–≤ –∫ —É—á–µ–±–µ?", "a": "–î–∞"}])
    return random.choice(subject_tasks)

def show_warmup(subject):
    if "warmup_done" not in st.session_state:
        st.session_state.warmup_done = False

    if not st.session_state.warmup_done:
        task = get_warmup_task(subject)
        
        st.markdown(f"### üèÉ‚Äç‚ôÇÔ∏è –†–∞–∑–º–∏–Ω–∫–∞ –ø–æ –ø—Ä–µ–¥–º–µ—Ç—É: {subject}")
        st.info(task['q'])
        
        answer = st.text_input("–¢–≤–æ–π –æ—Ç–≤–µ—Ç:", key="warmup_input")
        if st.button("–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–∑–º–∏–Ω–∫—É"):
            if answer.lower().strip() == task['a'].lower().strip():
                st.success("–ü—Ä–∞–≤–∏–ª—å–Ω–æ! –¢–µ–ø–µ—Ä—å –º–æ–∑–≥ –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ. üî•")
                st.session_state.warmup_done = True
                st.rerun()
            else:
                st.error(f"–ü–æ—á—Ç–∏! –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç: {task['a']}. –ü–æ–ø—Ä–æ–±—É–π –µ—â–µ —Ä–∞–∑ –∏–ª–∏ –Ω–∞—á–Ω–∏ —á–∞—Ç.")
